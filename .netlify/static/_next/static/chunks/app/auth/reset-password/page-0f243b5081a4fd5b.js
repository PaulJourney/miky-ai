(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4089],{285:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var a=t(5853),s=t(2115),n=t(4624),l=t(2085),i=t(9434);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:l,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,a.Y)(u,{className:(0,i.cn)(o({variant:s,size:l,className:t})),ref:r,...d})});c.displayName="Button"},637:(e,r,t)=>{"use strict";t.d(r,{g:()=>n});var a=t(5853),s=t(9434);function n(e){let{className:r,size:t="md"}=e;return(0,a.FD)("div",{className:(0,s.cn)("font-bold font-inter",{sm:"text-lg",md:"text-2xl",lg:"text-4xl",xl:"text-6xl"}[t],r),children:[(0,a.Y)("span",{className:"bg-gradient-to-r from-blue-600 via-blue-500 to-blue-400 bg-clip-text text-transparent",children:"Miky"}),(0,a.Y)("span",{className:"text-white",children:".ai"})]})}},1154:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1760:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=1760,e.exports=r},2099:(e,r,t)=>{"use strict";t.d(r,{Bh:()=>d,Hh:()=>n,Jv:()=>l,ND:()=>a,Rk:()=>c,f3:()=>o,xw:()=>i});let a=(0,t(2354).UU)("https://adwjbkjmehkypaetkejw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFkd2pia2ptZWhreXBhZXRrZWp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3Mjg0ODcsImV4cCI6MjA3MDMwNDQ4N30.R4XUc6-VNQcXWdioXKJ87x4dQyeguOFFP87KDiixk2g");function s(e){let r=Date.now().toString(36),t=e.split("@")[0].slice(0,4).toUpperCase(),a=Math.random().toString(36).substring(2,6).toUpperCase();return"".concat(t).concat(a).concat(r.slice(-3)).substring(0,10)}async function n(e,r,t,n){try{let{data:l,error:i}=await a.auth.signUp({email:e.toLowerCase(),password:r,options:{data:{full_name:t,referred_by:n||null}}});if(i)return{error:{message:i.message}};if(l.user){let{error:r}=await a.from("profiles").upsert({id:l.user.id,email:e.toLowerCase(),full_name:t,referral_code:s(e),referred_by:n||null,credits:100,water_cleaned_liters:0,subscription_plan:"free",subscription_status:"active",referral_level:1,total_referral_earnings:0,pending_payout:0,language:"en",is_admin:!1,is_mock:!1},{onConflict:"id"});r&&console.error("Profile creation error:",r)}return{data:l,error:null}}catch(e){return{error:{message:e.message||"An unexpected error occurred"}}}}async function l(e,r){try{let{data:t,error:s}=await a.auth.signInWithPassword({email:e.toLowerCase(),password:r});if(s){if(s.message.includes("Invalid login credentials"))return{error:{message:"Incorrect email or password. Please check your credentials and try again."}};if(s.message.includes("Email not confirmed"))return{error:{message:"Please check your email and click the verification link before signing in."}};return{error:{message:s.message}}}return{data:t,error:null}}catch(e){return{error:{message:e.message||"An unexpected error occurred"}}}}async function i(e){try{let{error:r}=await a.auth.resetPasswordForEmail(e,{redirectTo:"".concat("Miky.ai","/auth/reset-password")});if(r)return{error:{message:r.message}};return{error:null}}catch(e){return{error:{message:e.message||"An unexpected error occurred"}}}}async function o(e){try{let{error:r}=await a.auth.updateUser({password:e});if(r)return{error:{message:r.message}};return{error:null}}catch(e){return{error:{message:e.message||"An unexpected error occurred"}}}}async function c(){try{let{data:{user:o}}=await a.auth.getUser();if(!o)return{data:null,error:null};let{data:c,error:d}=await a.from("profiles").select("*").eq("id",o.id).single();if(d){if("PGRST116"===d.code){var e,r,t,n,l,i;console.log("Profile not found, creating new profile for user:",o.id);let{error:c}=await a.from("profiles").insert({id:o.id,email:(null==(e=o.email)?void 0:e.toLowerCase())||"",full_name:(null==(r=o.user_metadata)?void 0:r.full_name)||(null==(t=o.email)?void 0:t.split("@")[0])||"User",referral_code:s(o.email||""),credits:100,water_cleaned_liters:0,subscription_plan:"free",subscription_status:"active",referral_level:1,total_referral_earnings:0,pending_payout:0,language:"en",is_admin:!1,is_mock:!1});if(c){if(console.error("Error creating profile:",c),"42501"===c.code)return console.log("RLS policy blocking profile creation, returning default profile"),{data:{id:o.id,email:(null==(n=o.email)?void 0:n.toLowerCase())||"",full_name:(null==(l=o.user_metadata)?void 0:l.full_name)||(null==(i=o.email)?void 0:i.split("@")[0])||"User",avatar_url:null,referral_code:s(o.email||""),referred_by:null,credits:100,water_cleaned_liters:0,subscription_plan:"free",subscription_status:"active",stripe_customer_id:null,referral_level:1,total_referral_earnings:0,pending_payout:0,language:"en",is_admin:!1,is_mock:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},error:null};return{data:null,error:{message:c.message}}}let{data:d,error:u}=await a.from("profiles").select("*").eq("id",o.id).single();if(u)return{data:null,error:{message:u.message}};return{data:d,error:null}}return{data:null,error:{message:d.message}}}return{data:c,error:null}}catch(e){return{data:null,error:{message:e.message||"An unexpected error occurred"}}}}function d(e){return a.auth.onAuthStateChange(e)}},2523:(e,r,t)=>{"use strict";t.d(r,{p:()=>l});var a=t(5853),s=t(2115),n=t(9434);let l=s.forwardRef((e,r)=>{let{className:t,type:s,...l}=e;return(0,a.Y)("input",{type:s,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...l})});l.displayName="Input"},2657:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5311:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var a=t(5853),s=t(2115),n=t(8274),l=t(637),i=t(285),o=t(2523),c=t(646),d=t(5339),u=t(8749),m=t(2657),g=t(1154),h=t(7550),f=t(2099);function p(){let[e,r]=(0,s.useState)(""),[t,p]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),[w,x]=(0,s.useState)(!1),[v,N]=(0,s.useState)(!1),[_,k]=(0,s.useState)("form"),[Y,F]=(0,s.useState)(""),A=async r=>{if(r.preventDefault(),N(!0),F(""),e.length<6){F("Password must be at least 6 characters long"),N(!1);return}if(e!==t){F("Passwords do not match"),N(!1);return}let{error:a}=await (0,f.f3)(e);a?(F(a.message),k("error")):k("success"),N(!1)};return(0,a.Y)("div",{className:"min-h-screen bg-gray-950 text-white flex items-center justify-center p-4",children:(0,a.Y)("div",{className:"max-w-md w-full",children:(0,a.FD)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-900/50 backdrop-blur-xl rounded-3xl border border-white/10 p-8",children:[(0,a.FD)("div",{className:"text-center mb-8",children:[(0,a.Y)(l.g,{size:"md",className:"mb-6 justify-center"}),"form"===_&&(0,a.FD)(a.FK,{children:[(0,a.Y)("h1",{className:"text-2xl font-bold mb-2",children:"Reset Your Password"}),(0,a.Y)("p",{className:"text-gray-400",children:"Enter your new password below"})]}),"success"===_&&(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"w-16 h-16 bg-green-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.Y)(c.A,{className:"w-8 h-8 text-green-400"})}),(0,a.Y)("h1",{className:"text-2xl font-bold mb-2",children:"Password Updated!"}),(0,a.Y)("p",{className:"text-gray-400",children:"Your password has been successfully updated"})]}),"error"===_&&(0,a.FD)(a.FK,{children:[(0,a.Y)("div",{className:"w-16 h-16 bg-red-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.Y)(d.A,{className:"w-8 h-8 text-red-400"})}),(0,a.Y)("h1",{className:"text-2xl font-bold mb-2",children:"Update Failed"}),(0,a.Y)("p",{className:"text-gray-400",children:"There was an error updating your password"})]})]}),"form"===_&&(0,a.FD)(a.FK,{children:[Y&&(0,a.FD)("div",{className:"mb-4 p-3 bg-red-600/20 border border-red-600/30 rounded-lg flex items-center gap-2",children:[(0,a.Y)(d.A,{className:"w-4 h-4 text-red-400"}),(0,a.Y)("span",{className:"text-red-400 text-sm",children:Y})]}),(0,a.FD)("form",{onSubmit:A,className:"space-y-4",children:[(0,a.FD)("div",{className:"relative",children:[(0,a.Y)(o.p,{type:b?"text":"password",placeholder:"New password (min. 6 characters)",value:e,onChange:e=>r(e.target.value),className:"bg-white/5 border-white/10 text-white placeholder-gray-400 focus:border-blue-500 pr-10",minLength:6,required:!0}),(0,a.Y)("button",{type:"button",onClick:()=>y(!b),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",children:b?(0,a.Y)(u.A,{className:"w-4 h-4"}):(0,a.Y)(m.A,{className:"w-4 h-4"})})]}),(0,a.FD)("div",{className:"relative",children:[(0,a.Y)(o.p,{type:w?"text":"password",placeholder:"Confirm new password",value:t,onChange:e=>p(e.target.value),className:"bg-white/5 border-white/10 text-white placeholder-gray-400 focus:border-blue-500 pr-10",minLength:6,required:!0}),(0,a.Y)("button",{type:"button",onClick:()=>x(!w),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",children:w?(0,a.Y)(u.A,{className:"w-4 h-4"}):(0,a.Y)(m.A,{className:"w-4 h-4"})})]}),(0,a.Y)(i.$,{type:"submit",disabled:v,className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:v?(0,a.FD)(a.FK,{children:[(0,a.Y)(g.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating Password..."]}):"Update Password"})]})]}),"success"===_&&(0,a.FD)("div",{className:"space-y-4",children:[(0,a.Y)("div",{className:"bg-green-900/20 border border-green-600/30 rounded-lg p-4",children:(0,a.Y)("p",{className:"text-green-400 text-sm",children:"You can now sign in with your new password"})}),(0,a.Y)(i.$,{onClick:()=>window.location.href="/",className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:"Go to Sign In"})]}),"error"===_&&(0,a.FD)("div",{className:"space-y-4",children:[(0,a.Y)("div",{className:"bg-red-900/20 border border-red-600/30 rounded-lg p-4",children:(0,a.Y)("p",{className:"text-red-400 text-sm",children:Y||"The reset link may be invalid or expired. Please request a new one."})}),(0,a.Y)(i.$,{onClick:()=>k("form"),className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:"Try Again"})]}),(0,a.Y)("div",{className:"text-center mt-6",children:(0,a.FD)(i.$,{onClick:()=>window.location.href="/",variant:"outline",className:"border-gray-600 text-gray-300 hover:bg-gray-800",children:[(0,a.Y)(h.A,{className:"w-4 h-4 mr-2"}),"Back to Home"]})})]})})})}},5339:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5494:(e,r,t)=>{Promise.resolve().then(t.bind(t,5311))},7550:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8749:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(9946).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},9434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var a=t(2596),s=t(9688);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[5853,2497,7943,2354,8441,1684,7358],()=>r(5494)),_N_E=e.O()}]);